<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Portion Optimizer</title>
</head>
<body>
    <h1>Sustainable Portion Optimizer for Recipes</h1>
    <form id="recipeForm">
        <label for="recipe_name">Recipe Name:</label>
        <input type="text" id="recipe_name" name="recipe_name" required><br><br>

        <label for="adult_portions">Adult Portions:</label>
        <input type="number" id="adult_portions" name="adult_portions" required><br><br>

        <label for="child_portions">Child Portions:</label>
        <input type="number" id="child_portions" name="child_portions" required><br><br>

        <h2>Dietary Restrictions:</h2>
        <label>
            <input type="checkbox" id="vegetarian" name="dietary_restrictions" value="vegetarian">
            Vegetarian
        </label><br>
        <label>
            <input type="checkbox" id="vegan" name="dietary_restrictions" value="vegan">
            Vegan
        </label><br>
        <label>
            <input type="checkbox" id="peanut_free" name="dietary_restrictions" value="peanut_free">
            Peanut-Free
        </label><br>
        <label>
            <input type="checkbox" id="gluten_free" name="dietary_restrictions" value="gluten_free">
            Gluten-Free
        </label><br>
        <label>
            <input type="checkbox" id="lactose_free" name="dietary_restrictions" value="lactose_free">
            Lactose-Free
        </label><br><br>

        <button type="button" onclick="submitForm()">Submit</button>
    </form>

    <h2>Optimized Recipe:</h2>
    <div id="result"></div>

    <script>
        async function submitForm() {
            const formData = {
                recipe_name: document.getElementById("recipe_name").value,
                adult_portions: document.getElementById("adult_portions").value,
                child_portions: document.getElementById("child_portions").value,
                dietary_restrictions: {
                    vegetarian: document.getElementById("vegetarian").checked,
                    vegan: document.getElementById("vegan").checked,
                    peanut_free: document.getElementById("peanut_free").checked,
                    gluten_free: document.getElementById("gluten_free").checked,
                    lactose_free: document.getElementById("lactose_free").checked
                }
            };

            try {
                const response = await fetch("/optimize_recipe", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(formData),
                });

                if (response.ok) {
                    const result = await response.json();
                    document.getElementById("result").innerHTML = result.html;
                } else {
                    document.getElementById("result").innerHTML = `<p>Error: ${response.statusText}</p>`;
                }
            } catch (error) {
                document.getElementById("result").innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
